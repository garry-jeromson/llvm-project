# ld65 linker configuration for W65816 runtime tests
# Creates a flat binary suitable for loading in any 65816 emulator
#
# Memory layout:
#   $0000-$00FF: Zero page (test results at $0000-$000B)
#   $0100-$01FF: Stack
#   $0200-$7FFF: RAM (code and data)
#   $8000-$FFFF: ROM area (we put code here for typical ROM-based systems)
#
# The binary starts at $8000. Load and jump to $8000 to run.

MEMORY {
    ZP:     start = $0000, size = $0100, type = rw;
    STACK:  start = $0100, size = $0100, type = rw;
    RAM:    start = $0200, size = $7E00, type = rw;
    ROM:    start = $8000, size = $7FFA, type = ro, fill = yes, fillval = $00;
    VECTORS: start = $FFFA, size = $0006, type = ro, fill = yes;
}

SEGMENTS {
    ZEROPAGE: load = ZP, type = zp;
    BSS:      load = RAM, type = bss;
    CODE:     load = ROM, type = ro, start = $8000;
    VECTORS:  load = VECTORS, type = ro;
}

# Export the load address for reference
SYMBOLS {
    __LOADADDR__: type = export, value = $8000;
}
